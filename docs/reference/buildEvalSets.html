<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Build set carve-up for out-of sample evaluation. — buildEvalSets • vtreat</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Build set carve-up for out-of sample evaluation. — buildEvalSets"><meta property="og:description" content="Return a carve-up of seq_len(nRows).  Very useful for any sort of
nested model situation (such as data prep, stacking, or super-learning)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vtreat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/vtreat.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MultiClassVtreat.html">Multi Class vtreat</a>
    </li>
    <li>
      <a href="../articles/SavingTreamentPlans.html">Saving Treatment Plans</a>
    </li>
    <li>
      <a href="../articles/VariableImportance.html">vtreat Variable Importance</a>
    </li>
    <li>
      <a href="../articles/vtreatCrossFrames.html">vtreat cross frames</a>
    </li>
    <li>
      <a href="../articles/vtreatGrouping.html">vtreat grouping example</a>
    </li>
    <li>
      <a href="../articles/vtreatOverfit.html">vtreat overfit</a>
    </li>
    <li>
      <a href="../articles/vtreatRareLevels.html">vtreat Rare Levels</a>
    </li>
    <li>
      <a href="../articles/vtreatScaleMode.html">vtreat scale mode</a>
    </li>
    <li>
      <a href="../articles/vtreatSignificance.html">vtreat significance</a>
    </li>
    <li>
      <a href="../articles/vtreatSplitting.html">vtreat data splitting</a>
    </li>
    <li>
      <a href="../articles/vtreatVariableTypes.html">Variable Types</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://win-vector.com/" class="external-link">Sponsor: Win-Vector LLC</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Build set carve-up for out-of sample evaluation.</h1>
    <small class="dont-index">Source: <a href="https://github.com/WinVector/vtreat/blob/HEAD/R/outOfSample.R" class="external-link"><code>R/outOfSample.R</code></a></small>
    <div class="hidden name"><code>buildEvalSets.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Return a carve-up of seq_len(nRows).  Very useful for any sort of
nested model situation (such as data prep, stacking, or super-learning).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">buildEvalSets</span><span class="op">(</span></span>
<span>  <span class="va">nRows</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  dframe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  splitFunction <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nSplits <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>nRows</dt>
<dd><p>scalar, &gt;=1 number of rows to sample from.</p></dd>


<dt>...</dt>
<dd><p>no additional arguments, declared to forced named binding of later arguments.</p></dd>


<dt>dframe</dt>
<dd><p>(optional) original data.frame, passed to user splitFunction.</p></dd>


<dt>y</dt>
<dd><p>(optional) numeric vector, outcome variable (possibly to stratify on), passed to user splitFunction.</p></dd>


<dt>splitFunction</dt>
<dd><p>(optional) function taking arguments nSplits,nRows,dframe, and y; returning a user desired split.</p></dd>


<dt>nSplits</dt>
<dd><p>integer, target number of splits.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>list of lists where the app portion of the sub-lists is a disjoint carve-up of seq_len(nRows) and each list as a train portion disjoint from app.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Also sets attribute "splitmethod" on return value that describes how the split was performed.
attr(returnValue,'splitmethod') is one of: 'notsplit' (data was not split; corner cases
like single row data sets), 'oneway' (leave one out holdout), 'kwaycross' (a simple
partition), 'userfunction' (user supplied function was actually used), or a user specified attribute.
Any user
desired properties (such as stratification on y, or preservation of groups designated by 
original data row numbers) may not apply unless you see that 'userfunction' has been
used.</p>
<p>The intent is the user splitFunction only needs to handle "easy cases" 
and maintain user invariants. If the user splitFunction returns NULL,
throws, or returns an unacceptable carve-up then vtreat::buildEvalSets
returns its own eval set plan.  The signature of splitFunction should
be splitFunction(nRows,nSplits,dframe,y) where nSplits is the number of 
pieces we want in the carve-up, nRows is the number of rows to split,
dframe is the original dataframe (useful for any group control variables),
and y is a numeric vector representing outcome (useful for outcome stratification).</p>
<p>Note that buildEvalSets may not always return a partition (such
as one row dataframes), or if the user split function chooses to make rows eligible for
application a different number of times.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="kWayCrossValidation.html">kWayCrossValidation</a></code>, <code><a href="kWayStratifiedY.html">kWayStratifiedY</a></code>, and <code><a href="makekWayCrossValidationGroupedByColumn.html">makekWayCrossValidationGroupedByColumn</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use</span></span></span>
<span class="r-in"><span><span class="fu">buildEvalSets</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]$train</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   1   2   4   7   8  11  12  14  15  16  17  18  19  20  21  22  24  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [19]  26  27  29  32  33  36  37  39  40  41  42  43  44  46  47  48  49  50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [37]  51  53  54  56  59  60  62  65  66  67  69  71  72  73  75  76  77  78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [55]  81  82  83  84  85  88  89  91  93  94  95  96  97  98  99 100 101 102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 103 104 105 106 108 109 112 114 115 116 120 122 123 125 127 128 133 134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] 136 137 138 140 141 144 145 148 150 151 152 155 159 160 161 162 163 164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [109] 165 167 169 170 172 173 174 175 176 177 178 181 182 183 184 186 187 190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [127] 191 193 195 196 197 198 199 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]$app</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  30 130 132  61  70 131 157 139  10  28 124 153  45  90   3 121   5  13 129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20]  31  58 119  63 171 158  80  64 189 113   6   9 147 107  23 156  34 179 126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39]  86 188  68  52 118  35 135  74  55 117  57 180 146 111 185 149  79 142 110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58] 154  38 143 194 166 192  92 168  87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]$train</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   2   3   4   5   6   7   8   9  10  11  13  15  17  19  20  22  23  24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [19]  28  30  31  32  33  34  35  37  38  41  43  45  47  49  51  52  54  55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [37]  57  58  59  60  61  63  64  67  68  70  71  72  73  74  75  77  78  79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [55]  80  81  82  84  86  87  89  90  92  94  95  98 103 106 107 108 109 110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 111 112 113 114 117 118 119 120 121 122 124 126 129 130 131 132 134 135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] 137 138 139 140 142 143 145 146 147 149 151 152 153 154 156 157 158 161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [109] 162 164 166 167 168 169 171 176 177 179 180 184 185 186 187 188 189 190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [127] 191 192 194 195 196 198 199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]$app</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 197  26 133  53  25 141  36 170  44 155 125  40 150  97   1 165 127  29  27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] 104 116 115 123  12  42 174  62  76 172  21 173  96 183  56  14  93  85 136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] 181 105  91  69 178 100 102 182 101 160  18 193  46  88 159 163 128  39  16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58]  65  50 200  48 148 144 175  99  66  83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]$train</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   1   3   5   6   9  10  12  13  14  16  18  21  23  25  26  27  28  29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [19]  30  31  34  35  36  38  39  40  42  44  45  46  48  50  52  53  55  56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [37]  57  58  61  62  63  64  65  66  68  69  70  74  76  79  80  83  85  86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [55]  87  88  90  91  92  93  96  97  99 100 101 102 104 105 107 110 111 113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 115 116 117 118 119 121 123 124 125 126 127 128 129 130 131 132 133 135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] 136 139 141 142 143 144 146 147 148 149 150 153 154 155 156 157 158 159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [109] 160 163 165 166 168 170 171 172 173 174 175 178 179 180 181 182 183 185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [127] 188 189 192 193 194 197 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]$app</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 199  94  19 108 176  43  81  22  47 122 162 145 140 103 186 187  32  59 167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] 177  41   8  54 152  78  51 138 164   4  72 106 120  84  33  11  71  98  82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] 198  95  17 191 112   2 109  24 161  60 114 169  15 137 134 151  77   7  75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58]  89  20  49 196  67 195  37 190 184  73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"splitmethod")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "kwaycross"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># longer example</span></span></span>
<span class="r-in"><span><span class="co"># helper fns</span></span></span>
<span class="r-in"><span><span class="co"># fit models using experiment plan to estimate out of sample behavior</span></span></span>
<span class="r-in"><span><span class="va">fitModelAndApply</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">trainData</span>,<span class="va">applicaitonData</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">trainData</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>,newdata<span class="op">=</span><span class="va">applicaitonData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">simulateOutOfSampleTrainEval</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span>,<span class="va">fitApplyFn</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">eSets</span> <span class="op">&lt;-</span> <span class="fu">buildEvalSets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">evals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">eSets</span>, </span></span>
<span class="r-in"><span>      <span class="kw">function</span><span class="op">(</span><span class="va">ei</span><span class="op">)</span> <span class="op">{</span> <span class="fu">fitApplyFn</span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">ei</span><span class="op">$</span><span class="va">train</span>,<span class="op">]</span>,<span class="va">d</span><span class="op">[</span><span class="va">ei</span><span class="op">$</span><span class="va">app</span>,<span class="op">]</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="kw">for</span><span class="op">(</span><span class="va">eii</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">eSets</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">pred</span><span class="op">[</span><span class="va">eSets</span><span class="op">[[</span><span class="va">eii</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">app</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">evals</span><span class="op">[[</span><span class="va">eii</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>   <span class="op">}</span></span></span>
<span class="r-in"><span>   <span class="va">pred</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># run the experiment</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2352356</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># example data</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        outOfSampleEst<span class="op">=</span><span class="cn">NA</span>,inSampleEst<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span>        </span></span>
<span class="r-in"><span><span class="co"># fit model on all data</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">inSampleEst</span> <span class="op">&lt;-</span> <span class="fu">fitModelAndApply</span><span class="op">(</span><span class="va">d</span>,<span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># compute in-sample R^2 (above zero, falsely shows a </span></span></span>
<span class="r-in"><span><span class="co">#   relation until we adjust for degrees of freedom)</span></span></span>
<span class="r-in"><span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">y</span><span class="op">-</span><span class="va">d</span><span class="op">$</span><span class="va">inSampleEst</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">y</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4193942</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">outOfSampleEst</span> <span class="op">&lt;-</span> <span class="fu">simulateOutOfSampleTrainEval</span><span class="op">(</span><span class="va">d</span>,<span class="va">fitModelAndApply</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># compute out-sample R^2 (not positive, </span></span></span>
<span class="r-in"><span><span class="co">#  evidence of no relation)</span></span></span>
<span class="r-in"><span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">y</span><span class="op">-</span><span class="va">d</span><span class="op">$</span><span class="va">outOfSampleEst</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">y</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -3.873148</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by John Mount, Nina Zumel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

